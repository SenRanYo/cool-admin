import{d as y,a as L}from"./@vue.runtime-dom-7b7b8a44.js";import{_ as N}from"./logo-5b4cc875.js";import{u as S}from"./index-e77a39a7.js";import"./store-4dd21bbb.js";import{u as I}from"./index-8d3b4b42.js";import{a as d}from"./element-plus-aceaa6a8.js";import{d as v,e as U,o as _,c as f,W as x,a as s,b as l,J as c,K as w,N as $,am as D,al as E}from"./@vue.runtime-core-3a9e54b6.js";import{r as C,j as H,u as k}from"./@vue.reactivity-747ae439.js";import{_ as T}from"./_plugin-vue_export-helper-c27b6911.js";import{O as j}from"./@vue.shared-9aa0355e.js";import"./monaco-editor-9ddaeaf3.js";import"./axios-aba6f0e0.js";import"./nprogress-d2c1a460.js";import"./chardet-ee49d9b4.js";import"./lodash-es-d00cf236.js";import"./@vueuse.core-b5ce6112.js";import"./@vueuse.shared-8ce56883.js";import"./mitt-b509fb6d.js";import"./vue-router-19ed6b98.js";import"./pinia-2b0aea45.js";import"./vue-demi-71ba0ef2.js";import"./vue-echarts-c84fbe77.js";import"./resize-detector-a5205554.js";import"./echarts-90e4e057.js";import"./tslib-54e39b60.js";import"./zrender-5c8f9fce.js";import"./mockjs-5923ee6a.js";import"./vue-1fcee0a5.js";import"./@element-plus.icons-vue-e3809a99.js";import"./@popperjs.core-c75af06c.js";import"./@ctrl.tinycolor-384ef2e5.js";import"./dayjs-98968027.js";import"./async-validator-dee29e8b.js";import"./memoize-one-297ddbcb.js";import"./escape-html-1d60d822.js";import"./normalize-wheel-es-ed76fb12.js";import"./@floating-ui.dom-a30dd394.js";import"./@floating-ui.core-a4bcb9d9.js";const J=["innerHTML"],O=["src"],P=v({name:"undefined"}),R=v({...P,emits:["update:modelValue","change"],setup(p,{expose:h,emit:u}){const{service:g}=I(),m=C(""),r=C("");function n(){g.base.open.captcha({height:40,width:150}).then(({captchaId:o,data:e})=>{e.includes(";base64,")?m.value=e:r.value=e,u("update:modelValue",o),u("change",{base64:m,svg:r,captchaId:o})}).catch(o=>{d.error(o.message)})}return U(()=>{n()}),h({refresh:n}),(o,e)=>(_(),f("div",{class:"captcha",onClick:n},[r.value?(_(),f("div",{key:0,class:"svg",innerHTML:r.value},null,8,J)):(_(),f("img",{key:1,class:"base64",src:m.value,alt:""},null,8,O))]))}});const W=T(R,[["__scopeId","data-v-e10ae32d"]]),M=p=>(D("data-v-441b8c93"),p=p(),E(),p),q={class:"page-login"},z={class:"box"},A={class:"logo"},F=M(()=>s("img",{src:N,alt:"Logo"},null,-1)),G=M(()=>s("p",{class:"desc"},"一款快速开发后台权限管理系统",-1)),Q={class:"row"},X=["onKeyup"],Y={class:"op"},Z=v({name:"login"}),ee=v({...Z,setup(p){const{refs:h,setRefs:u,router:g,service:m}=I(),{user:r,app:n}=S(),o=C(!1),e=H({username:"",password:"",captchaId:"",verifyCode:""});async function V(){if(!e.username)return d.error("用户名不能为空");if(!e.password)return d.error("密码不能为空");if(!e.verifyCode)return d.error("图片验证码不能为空");o.value=!0;try{await m.base.open.login(e).then(i=>{r.setToken(i)}),await Promise.all(n.events.hasToken.map(i=>i())),g.push("/")}catch(i){h.captcha.refresh(),d.error(i.message)}o.value=!1}return(i,t)=>{const b=x("el-form-item"),B=x("el-button"),K=x("el-form");return _(),f("div",q,[s("div",z,[s("div",A,[F,s("span",null,j(k(n).info.name),1)]),G,l(K,{"label-position":"top",class:"form",disabled:o.value},{default:c(()=>[l(b,{label:"用户名"},{default:c(()=>[w(s("input",{"onUpdate:modelValue":t[0]||(t[0]=a=>e.username=a),placeholder:"请输入用户名",maxlength:"20",autocomplete:"on"},null,512),[[y,e.username]])]),_:1}),l(b,{label:"密码"},{default:c(()=>[w(s("input",{"onUpdate:modelValue":t[1]||(t[1]=a=>e.password=a),type:"password",placeholder:"请输入密码",maxlength:"20",autocomplete:"off"},null,512),[[y,e.password]])]),_:1}),l(b,{label:"验证码"},{default:c(()=>[s("div",Q,[w(s("input",{"onUpdate:modelValue":t[2]||(t[2]=a=>e.verifyCode=a),placeholder:"图片验证码",maxlength:"4",onKeyup:L(V,["enter"])},null,40,X),[[y,e.verifyCode]]),l(W,{ref:k(u)("captcha"),modelValue:e.captchaId,"onUpdate:modelValue":t[3]||(t[3]=a=>e.captchaId=a),onChange:t[4]||(t[4]=()=>{e.verifyCode=""})},null,8,["modelValue"])])]),_:1}),s("div",Y,[l(B,{round:"",loading:o.value,onClick:V},{default:c(()=>[$("登录")]),_:1},8,["loading"])])]),_:1},8,["disabled"])])])}}});const je=T(ee,[["__scopeId","data-v-441b8c93"]]);export{je as default};
