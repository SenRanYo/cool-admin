import{watch as e,inject as t,computed as n,unref as r,watchEffect as o,Vue2 as i,defineComponent as a,shallowRef as u,toRefs as c,getCurrentInstance as s,onMounted as l,onUnmounted as p,h as f,nextTick as v}from"vue-demi";import{throttle as d,init as g}from"echarts/core";import{addListener as h,removeListener as O}from"resize-detector";var m=function(){return m=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},m.apply(this,arguments)},b=["getWidth","getHeight","getDom","getOption","resize","dispatchAction","convertToPixel","convertFromPixel","containPixel","getDataURL","getConnectedDataURL","appendData","clear","isDisposed","dispose"];function y(e){return t=Object.create(null),b.forEach((function(n){t[n]=function(t){return function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];if(!e.value)throw new Error("ECharts is not initialized yet.");return e.value[t].apply(e.value,n)}}(n)})),t;var t}var x={autoresize:Boolean},j="ecLoadingOptions";var _={loading:Boolean,loadingOptions:Object},E=/^on[^a-z]/,A=function(e){return E.test(e)};var z=[],L=[];!function(e,t){if(e&&"undefined"!=typeof document){var n,r=!0===t.prepend?"prepend":"append",o=!0===t.singleTag,i="string"==typeof t.container?document.querySelector(t.container):document.getElementsByTagName("head")[0];if(o){var a=z.indexOf(i);-1===a&&(a=z.push(i)-1,L[a]={}),n=L[a]&&L[a][r]?L[a][r]:L[a][r]=u()}else n=u();65279===e.charCodeAt(0)&&(e=e.substring(1)),n.styleSheet?n.styleSheet.cssText+=e:n.appendChild(document.createTextNode(e))}function u(){var e=document.createElement("style");if(e.setAttribute("type","text/css"),t.attributes)for(var n=Object.keys(t.attributes),o=0;o<n.length;o++)e.setAttribute(n[o],t.attributes[n[o]]);var a="prepend"===r?"afterbegin":"beforeend";return i.insertAdjacentElement(a,e),e}}("x-vue-echarts{display:block;width:100%;height:100%}",{});i&&i.config.ignoredElements.push("x-vue-echarts");var w="ecTheme",T="ecInitOptions",U="ecUpdateOptions",C=a({name:"echarts",props:m(m({option:Object,theme:{type:[Object,String]},initOptions:Object,updateOptions:Object,group:String,manualUpdate:Boolean},x),_),inheritAttrs:!1,setup:function(i,a){var f=a.attrs,b=u(),x=u(),j=u(),_=t("ecTheme",null),E=t("ecInitOptions",null),z=t("ecUpdateOptions",null),L=c(i),w=L.autoresize,T=L.manualUpdate,U=L.loading,C=L.loadingOptions,D=n((function(){return j.value||i.option||null})),S=n((function(){return i.theme||r(_)||{}})),k=n((function(){return i.initOptions||r(E)||{}})),B=n((function(){return i.updateOptions||r(z)||{}})),P=n((function(){return function(e){var t={};for(var n in e)A(n)||(t[n]=e[n]);return t}(f)})),I=s().proxy.$listeners;function N(e){if(b.value){var t=x.value=g(b.value,S.value,k.value);i.group&&(t.group=i.group);var n=I;n||(n={},Object.keys(f).filter((function(e){return 0===e.indexOf("on")&&e.length>2})).forEach((function(e){var t=e.charAt(2).toLowerCase()+e.slice(3);"Once"===t.substring(t.length-4)&&(t="~".concat(t.substring(0,t.length-4))),n[t]=f[e]}))),Object.keys(n).forEach((function(e){var r=n[e];if(r){var o=e.toLowerCase();"~"===o.charAt(0)&&(o=o.substring(1),r.__once__=!0);var i=t;if(0===o.indexOf("zr:")&&(i=t.getZr(),o=o.substring(3)),r.__once__){delete r.__once__;var a=r;r=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];a.apply(void 0,e),i.off(o,r)}}i.on(o,r)}})),w.value?v((function(){t&&!t.isDisposed()&&t.resize(),r()})):r()}function r(){var n=e||D.value;n&&t.setOption(n,B.value)}}function R(){x.value&&(x.value.dispose(),x.value=void 0)}var q=null;e(T,(function(t){"function"==typeof q&&(q(),q=null),t||(q=e((function(){return i.option}),(function(e,t){e&&(x.value?x.value.setOption(e,m({notMerge:e.value!==(null==t?void 0:t.value)},B.value)):N())}),{deep:!0}))}),{immediate:!0}),e([S,k],(function(){R(),N()}),{deep:!0}),o((function(){i.group&&x.value&&(x.value.group=i.group)}));var F=y(x);return function(e,i,a){var u=t("ecLoadingOptions",{}),c=n((function(){return m(m({},r(u)),null==a?void 0:a.value)}));o((function(){var t=e.value;t&&(i.value?t.showLoading(c.value):t.hideLoading())}))}(x,U,C),function(t,n,r){var o=null;e([r,t,n],(function(e,t,n){var r=e[0],i=e[1],a=e[2];r&&i&&a&&(o=d((function(){i.resize()}),100),h(r,o)),n((function(){o&&r&&O(r,o)}))}))}(x,w,b),l((function(){N()})),p(R),m({chart:x,root:b,setOption:function(e,t){i.manualUpdate&&(j.value=e),x.value?x.value.setOption(e,t||{}):N(e)},nonEventAttrs:P},F)},render:function(){var e=m({},this.nonEventAttrs);return e.ref="root",e.class=e.class?["echarts"].concat(e.class):"echarts",f("x-vue-echarts",e)}});export{T as INIT_OPTIONS_KEY,j as LOADING_OPTIONS_KEY,w as THEME_KEY,U as UPDATE_OPTIONS_KEY,C as default};
//# sourceMappingURL=index.esm.min.js.map
