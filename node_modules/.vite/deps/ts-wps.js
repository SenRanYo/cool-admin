import "./chunk-LFBQMW2U.js";

// node_modules/ts-wps/dist/index.esm.js
var e = function() {
  return (e = Object.assign || function(e2) {
    for (var n2, t2 = 1, r2 = arguments.length; t2 < r2; t2++)
      for (var i2 in n2 = arguments[t2])
        Object.prototype.hasOwnProperty.call(n2, i2) && (e2[i2] = n2[i2]);
    return e2;
  }).apply(this, arguments);
};
function n(e2, n2, t2, r2) {
  return new (t2 || (t2 = Promise))(function(i2, o2) {
    function a2(e3) {
      try {
        s2(r2.next(e3));
      } catch (e4) {
        o2(e4);
      }
    }
    function c2(e3) {
      try {
        s2(r2.throw(e3));
      } catch (e4) {
        o2(e4);
      }
    }
    function s2(e3) {
      var n3;
      e3.done ? i2(e3.value) : (n3 = e3.value, n3 instanceof t2 ? n3 : new t2(function(e4) {
        e4(n3);
      })).then(a2, c2);
    }
    s2((r2 = r2.apply(e2, n2 || [])).next());
  });
}
function t(e2, n2) {
  var t2, r2, i2, o2, a2 = { label: 0, sent: function() {
    if (1 & i2[0])
      throw i2[1];
    return i2[1];
  }, trys: [], ops: [] };
  return o2 = { next: c2(0), throw: c2(1), return: c2(2) }, "function" == typeof Symbol && (o2[Symbol.iterator] = function() {
    return this;
  }), o2;
  function c2(o3) {
    return function(c3) {
      return function(o4) {
        if (t2)
          throw new TypeError("Generator is already executing.");
        for (; a2; )
          try {
            if (t2 = 1, r2 && (i2 = 2 & o4[0] ? r2.return : o4[0] ? r2.throw || ((i2 = r2.return) && i2.call(r2), 0) : r2.next) && !(i2 = i2.call(r2, o4[1])).done)
              return i2;
            switch (r2 = 0, i2 && (o4 = [2 & o4[0], i2.value]), o4[0]) {
              case 0:
              case 1:
                i2 = o4;
                break;
              case 4:
                return a2.label++, { value: o4[1], done: false };
              case 5:
                a2.label++, r2 = o4[1], o4 = [0];
                continue;
              case 7:
                o4 = a2.ops.pop(), a2.trys.pop();
                continue;
              default:
                if (!(i2 = (i2 = a2.trys).length > 0 && i2[i2.length - 1]) && (6 === o4[0] || 2 === o4[0])) {
                  a2 = 0;
                  continue;
                }
                if (3 === o4[0] && (!i2 || o4[1] > i2[0] && o4[1] < i2[3])) {
                  a2.label = o4[1];
                  break;
                }
                if (6 === o4[0] && a2.label < i2[1]) {
                  a2.label = i2[1], i2 = o4;
                  break;
                }
                if (i2 && a2.label < i2[2]) {
                  a2.label = i2[2], a2.ops.push(o4);
                  break;
                }
                i2[2] && a2.ops.pop(), a2.trys.pop();
                continue;
            }
            o4 = n2.call(e2, a2);
          } catch (e3) {
            o4 = [6, e3], r2 = 0;
          } finally {
            t2 = i2 = 0;
          }
        if (5 & o4[0])
          throw o4[1];
        return { value: o4[0] ? o4[1] : void 0, done: true };
      }([o3, c3]);
    };
  }
}
var r = function() {
  function e2() {
  }
  return e2.add = function(n2) {
    e2.HANDLE_LIST.push(n2), window.addEventListener("message", n2, false);
  }, e2.remove = function(n2) {
    var t2 = e2.HANDLE_LIST.indexOf(n2);
    t2 >= 0 && e2.HANDLE_LIST.splice(t2, 1), window.removeEventListener("message", n2, false);
  }, e2.empty = function() {
    for (; e2.HANDLE_LIST.length; )
      window.removeEventListener("message", e2.HANDLE_LIST.shift(), false);
  }, e2.parse = function(e3) {
    try {
      return "object" == typeof e3 ? e3 : e3 ? JSON.parse(e3) : e3;
    } catch (n2) {
      return console.log("Message.parse Error:", n2), e3;
    }
  }, e2.HANDLE_LIST = [], e2;
}();
function i(e2) {
  if (!e2)
    return false;
  for (var n2 = e2; null !== Object.getPrototypeOf(n2); )
    n2 = Object.getPrototypeOf(n2);
  return Object.getPrototypeOf(e2) === n2;
}
function o(e2) {
  return "[object Function]" === {}.toString.call(e2);
}
var a;
var c;
var s;
var u;
var l;
var f = { origin: "" };
function p(e2, n2) {
  f[e2] = n2;
}
function d(e2) {
  return f[e2];
}
function v(e2) {
  var n2 = d("origin");
  return !!function(e3, n3) {
    return e3 !== n3 && (e3.replace(/www\./i, "").toLowerCase() !== n3.replace(/www\./i, "").toLowerCase() || (e3.match("www.") ? void 0 : (p("origin", n3), false)));
  }(n2, e2.origin) && (console.warn("postMessage 域名检查不通过", { safeOrigin: n2, eventOrigin: e2.origin }), true);
}
!function(e2) {
  e2.Spreadsheet = "s", e2.Writer = "w", e2.Presentation = "p", e2.Pdf = "f";
}(a || (a = {})), function(e2) {
  e2.unknown = "unknown", e2.spreadsheet = "s", e2.writer = "w", e2.presentation = "p", e2.pdf = "f";
}(c || (c = {})), function(e2) {
  e2.wps = "w", e2.et = "s", e2.presentation = "p", e2.pdf = "f";
}(s || (s = {})), function(e2) {
  e2.nomal = "nomal", e2.simple = "simple";
}(u || (u = {})), function(e2) {
  e2[e2.requestFullscreen = 1] = "requestFullscreen", e2[e2.exitFullscreen = 0] = "exitFullscreen";
}(l || (l = {}));
var h;
var b;
var m;
var g = (h = 0, function() {
  return h += 1;
});
var w = function(e2, n2, t2) {
  void 0 === t2 && (t2 = true);
  var r2 = "string" == typeof n2 ? document.querySelector(n2) : n2;
  if (!b) {
    var i2 = function e3(n3) {
      var t3 = n3.clientHeight;
      var r3 = n3.clientWidth;
      0 !== t3 || 0 !== r3 || m ? 0 === t3 && 0 === r3 || !m || (m.disconnect(), m = null) : window.ResizeObserver && (m = new ResizeObserver(function(t4) {
        e3(n3);
      })).observe(n3);
      b.style.cssText += "height: " + t3 + "px; width: " + r3 + "px";
    }.bind(null, r2);
    (b = document.createElement("iframe")).classList.add("web-office-iframe");
    var o2 = { id: "office-iframe", src: e2, scrolling: "no", frameborder: "0", allowfullscreen: "allowfullscreen", webkitallowfullscreen: "true", mozallowfullscreen: "true", allow: "clipboard-read; clipboard-write" };
    for (var a2 in r2 ? (o2.style = "width: " + r2.clientWidth + "px; height: " + r2.clientHeight + "px;", t2 && window.addEventListener("resize", i2)) : ((r2 = document.createElement("div")).classList.add("web-office-default-container"), function(e3) {
      var n3 = document.createElement("style");
      document.head.appendChild(n3);
      var t3 = n3.sheet;
      t3.insertRule(e3, t3.cssRules.length);
    }(".web-office-default-container {position: absolute; padding: 0;  margin: 0; width: 100%; height: 100%; left: 0; top: 0;}"), document.body.appendChild(r2), o2.style = "position: fixed; top: 0; right: 0; bottom: 0; left: 0; width: 100%; height: 100%;"), o2)
      b.setAttribute(a2, o2[a2]);
    r2.appendChild(b), b.destroy = function() {
      b.parentNode.removeChild(b), b = null, window.removeEventListener("resize", i2), m && (m.disconnect(), m = null);
    };
  }
  return b;
};
var y = function(e2) {
  w().contentWindow && w().contentWindow.postMessage(JSON.stringify(e2), d("origin"));
};
function k(e2, n2, t2) {
  return new Promise(function(i2) {
    var o2 = g(), a2 = function(e3) {
      if (!v(e3)) {
        var n3 = r.parse(e3.data);
        n3.eventName === t2 && n3.msgId === o2 && (i2(n3.data), r.remove(a2));
      }
    };
    r.add(a2), y({ data: e2, msgId: o2, eventName: n2 });
  });
}
var O = function(e2) {
  return k(e2, "wps.jssdk.api", "wps.api.reply");
};
var I = function(e2) {
  return k(e2, "api.basic", "api.basic.reply");
};
var j = { idMap: {} };
function E(e2) {
  return n(this, void 0, void 0, function() {
    var n2, i2, o2, a2, c2, s2, u2, l2, f2, p2;
    return t(this, function(t2) {
      switch (t2.label) {
        case 0:
          return v(e2) ? [2] : (n2 = r.parse(e2.data), i2 = n2.eventName, o2 = n2.callbackId, a2 = n2.data, o2 && (c2 = j.idMap[o2]) ? (s2 = c2.split(":"), u2 = s2[0], l2 = s2[1], "api.callback" === i2 && j[u2] && j[u2][l2] ? [4, (p2 = j[u2][l2]).callback.apply(p2, a2.args)] : [3, 2]) : [3, 2]);
        case 1:
          f2 = t2.sent(), y({ result: f2, callbackId: o2, eventName: "api.callback.reply" }), t2.label = 2;
        case 2:
          return [2];
      }
    });
  });
}
var T = function(e2) {
  return n(void 0, void 0, void 0, function() {
    function n2() {
      return Object.keys(j.idMap).find(function(e3) {
        return j.idMap[e3] === o2 + ":" + i2;
      });
    }
    var i2, o2, a2, c2, s2, u2, l2, f2, p2;
    return t(this, function(t2) {
      switch (t2.label) {
        case 0:
          return i2 = e2.prop, o2 = e2.parentObjId, [4, _([a2 = e2.value])];
        case 1:
          return c2 = t2.sent(), s2 = c2[0], u2 = c2[1], e2.value = s2[0], l2 = Object.keys(u2)[0], f2 = j[o2], null === a2 && f2 && f2[i2] && ((p2 = n2()) && delete j.idMap[p2], delete f2[i2], Object.keys(f2).length || delete j[o2], Object.keys(j.idMap).length || r.remove(E)), l2 && (Object.keys(j.idMap).length || r.add(E), j[o2] || (j[o2] = {}), j[o2][i2] = { callbackId: l2, callback: u2[l2] }, (p2 = n2()) && delete j.idMap[p2], j.idMap[l2] = o2 + ":" + i2), [2];
      }
    });
  });
};
var S = function(i2, o2, a2, c2) {
  return n(void 0, void 0, void 0, function() {
    var s2, u2, l2, f2, p2, d2, h2, b2;
    return t(this, function(m2) {
      switch (m2.label) {
        case 0:
          return s2 = g(), f2 = new Promise(function(e2, n2) {
            u2 = e2, l2 = n2;
          }), p2 = {}, o2.args ? [4, _(o2.args)] : [3, 2];
        case 1:
          d2 = m2.sent(), h2 = d2[0], b2 = d2[1], o2.args = h2, p2 = b2, m2.label = 2;
        case 2:
          return "api.setter" !== i2 ? [3, 4] : [4, T(o2)];
        case 3:
          m2.sent(), m2.label = 4;
        case 4:
          return function(n2) {
            var t2 = n2[0], r2 = n2[1];
            "function" == typeof (t2 = e({}, t2)).data && (t2.data = t2.data());
            r2(), y(t2);
          }([{ eventName: i2, data: o2, msgId: s2 }, function() {
            var e2 = this, o3 = function(f3) {
              return n(e2, void 0, void 0, function() {
                var e3, n2, d3;
                return t(this, function(t2) {
                  switch (t2.label) {
                    case 0:
                      return v(f3) ? [2] : "api.callback" === (e3 = r.parse(f3.data)).eventName && e3.callbackId && p2[e3.callbackId] ? [4, p2[e3.callbackId].apply(p2, e3.data.args)] : [3, 2];
                    case 1:
                      n2 = t2.sent(), y({ result: n2, eventName: "api.callback.reply", callbackId: e3.callbackId }), t2.label = 2;
                    case 2:
                      return e3.eventName === i2 + ".reply" && e3.msgId === s2 && (e3.error ? ((d3 = new Error("")).stack = e3.error + "\n" + a2, c2 && c2(), l2(d3)) : u2(e3.result), r.remove(o3)), [2];
                  }
                });
              });
            };
            return r.add(o3), f2;
          }]), [2, f2];
      }
    });
  });
};
function _(e2) {
  return n(this, void 0, void 0, function() {
    var n2, r2, o2, a2, c2, s2, u2, l2, f2, p2, d2;
    return t(this, function(t2) {
      switch (t2.label) {
        case 0:
          n2 = {}, r2 = [], o2 = e2.slice(0), t2.label = 1;
        case 1:
          return o2.length ? (a2 = void 0, [4, o2.shift()]) : [3, 13];
        case 2:
          return (c2 = t2.sent()) && c2.done ? [4, c2.done()] : [3, 4];
        case 3:
          t2.sent(), t2.label = 4;
        case 4:
          if (!i(a2))
            return [3, 11];
          for (u2 in a2 = {}, s2 = [], c2)
            s2.push(u2);
          l2 = 0, t2.label = 5;
        case 5:
          return l2 < s2.length ? (f2 = s2[l2], p2 = c2[f2], /^[A-Z]/.test(f2) ? p2 && p2.done ? [4, p2.done()] : [3, 7] : [3, 8]) : [3, 10];
        case 6:
          t2.sent(), t2.label = 7;
        case 7:
          p2 && p2.objId ? p2 = { objId: p2.objId } : "function" == typeof p2 && (d2 = g(), n2[d2] = p2, p2 = { callbackId: d2 }), t2.label = 8;
        case 8:
          a2[f2] = p2, t2.label = 9;
        case 9:
          return l2++, [3, 5];
        case 10:
          return [3, 12];
        case 11:
          c2 && c2.objId ? a2 = { objId: c2.objId } : "function" == typeof c2 && void 0 === c2.objId ? (d2 = g(), n2[d2] = c2, a2 = { callbackId: d2 }) : a2 = c2, t2.label = 12;
        case 12:
          return r2.push(a2), [3, 1];
        case 13:
          return [2, [r2, n2]];
      }
    });
  });
}
var x = function(n2, t2) {
  void 0 === t2 && (t2 = true);
  var r2 = e({}, n2), i2 = r2.headers, o2 = void 0 === i2 ? {} : i2, a2 = r2.subscriptions, c2 = void 0 === a2 ? {} : a2, s2 = r2.mode, l2 = void 0 === s2 ? u.nomal : s2, f2 = r2.commonOptions, p2 = o2.backBtn, d2 = void 0 === p2 ? {} : p2, v2 = o2.shareBtn, h2 = void 0 === v2 ? {} : v2, b2 = o2.otherMenuBtn, m2 = void 0 === b2 ? {} : b2, g2 = function(e2, n3) {
    e2.subscribe && "function" == typeof e2.subscribe && (e2.callback = n3, c2[n3] = e2.subscribe, t2 && delete e2.subscribe);
  };
  if (g2(d2, "wpsconfig_back_btn"), g2(h2, "wpsconfig_share_btn"), g2(m2, "wpsconfig_other_menu_btn"), m2.items && Array.isArray(m2.items)) {
    var w2 = [];
    m2.items.forEach(function(e2, n3) {
      switch (void 0 === e2 && (e2 = {}), e2.type) {
        case "export_img":
          e2.type = 1, e2.callback = "export_img";
          break;
        case "export_pdf":
          e2.type = 1, e2.callback = "export_pdf";
          break;
        case "save_version":
          e2.type = 1, e2.callback = "save_version";
          break;
        case "about_wps":
          e2.type = 1, e2.callback = "about_wps";
          break;
        case "split_line":
          e2.type = 2;
          break;
        case "custom":
          e2.type = 3, g2(e2, "wpsconfig_other_menu_btn_" + n3), w2.push(e2);
      }
    }), w2.length && (D || P) && (m2.items = w2);
  }
  r2.url = r2.url || r2.wpsUrl;
  var y2 = [];
  if ((l2 === u.simple || f2 && false === f2.isShowTopArea) && y2.push("simple", "hidecmb"), r2.debug && y2.push("debugger"), r2.url && y2.length && (r2.url = r2.url + (r2.url.indexOf("?") >= 0 ? "&" : "?") + y2.join("&")), f2 && (f2.isParentFullscreen || f2.isBrowserViewFullscreen) && (document.addEventListener("fullscreenchange", F), document.addEventListener("webkitfullscreenchange", F), document.addEventListener("mozfullscreenchange", F)), r2.wordOptions && (r2.wpsOptions = r2.wordOptions), r2.excelOptions && (r2.etOptions = r2.excelOptions), r2.pptOptions && (r2.wppOptions = r2.pptOptions), "object" == typeof c2.print) {
    var k2 = "wpsconfig_print";
    "function" == typeof c2.print.subscribe && (c2[k2] = c2.print.subscribe, r2.print = { callback: k2 }, void 0 !== c2.print.custom && (r2.print.custom = c2.print.custom)), delete c2.print;
  }
  "function" == typeof c2.exportPdf && (c2[k2 = "wpsconfig_export_pdf"] = c2.exportPdf, r2.exportPdf = { callback: k2 }, delete c2.exportPdf);
  return r2.commandBars && N(r2.commandBars, false), e(e({}, r2), { subscriptions: c2 });
};
var C = function(n2) {
  var t2 = e({}, n2), r2 = t2.appId, o2 = t2.fileId, c2 = t2.officeType, s2 = t2.fileToken, u2 = t2.endpoint, l2 = t2.customArgs, f2 = void 0 === l2 ? "" : l2;
  if (!Object.values(a).includes(c2))
    throw Error("[WebOfficeSDK.init] officeType属性值错误，可选值参考WebOfficeSDK.OfficeType: " + JSON.stringify(a));
  var p2 = s2 ? 1 : 0, d2 = { token: "" };
  if ("string" == typeof s2 ? d2.token = s2 : i(s2) && (d2 = e({ tokenData: d2 }, s2)), p2 && !d2.token)
    return console.error("[WebOfficeSDK.init] fileToken设置无效"), t2;
  if ("string" != typeof u2)
    throw Error("[WebOfficeSDK.init] endpoint期望为字符串");
  if (u2 && !u2.startsWith("http"))
    return console.error("[WebOfficeSDK.init] endpoint仅支持http、https的地址"), t2;
  if (t2.url = u2 + "/office/" + c2 + "/" + o2 + "?_w_appid=" + r2 + "&_w_tokentype=" + p2, i(f2)) {
    var v2 = Object.entries(f2).map(function(e2) {
      var n3 = e2[0], t3 = e2[1];
      return n3 + "=" + encodeURIComponent(t3);
    }).join("&");
    t2.url = t2.url + "&" + v2;
  }
  return e({}, t2);
};
var A = function(e2) {
  void 0 === e2 && (e2 = "");
  var n2 = "";
  if (!n2 && e2) {
    var t2 = e2.toLowerCase();
    -1 !== t2.indexOf("/office/s/") && (n2 = c.spreadsheet), -1 !== t2.indexOf("/office/w/") && (n2 = c.writer), -1 !== t2.indexOf("/office/p/") && (n2 = c.presentation), -1 !== t2.indexOf("/office/f/") && (n2 = c.pdf);
  }
  if (!n2) {
    var r2 = e2.match(/[\?&]type=([a-z]+)/) || [];
    n2 = s[r2[1]] || "";
  }
  return n2;
};
function N(e2, n2) {
  void 0 === n2 && (n2 = true);
  var t2 = e2.map(function(e3) {
    var n3 = e3.attributes;
    if (!Array.isArray(n3)) {
      var t3 = [];
      for (var r2 in n3)
        if (n3.hasOwnProperty(r2)) {
          var i2 = { name: r2, value: n3[r2] };
          t3.push(i2);
        }
      e3.attributes = t3;
    }
    return e3;
  });
  return n2 && y({ data: t2, eventName: "setCommandBars" }), t2;
}
var L = window.navigator.userAgent.toLowerCase();
var D = /Android|webOS|iPhone|iPod|BlackBerry|iPad/i.test(L);
var P = function() {
  try {
    return -1 !== window._parent.location.search.indexOf("from=wxminiprogram");
  } catch (e2) {
    return false;
  }
}();
function F() {
  var e2 = { status: l.requestFullscreen }, n2 = document, t2 = n2.fullscreenElement || n2.webkitFullscreenElement || n2.mozFullScreenElement;
  e2.status = t2 ? l.requestFullscreen : l.exitFullscreen, y({ data: e2, eventName: "fullscreenchange" });
}
var B = function() {
  j.idMap = {};
};
function W() {
  console.group("JSSDK 事件机制调整说明"), console.warn("jssdk.on、jssdk.off 和 jssdk.Application.Sub 将在后续版本中被弃用，建议使用改进后的 ApiEvent"), console.warn("具体请参考：https://wwo.wps.cn/docs/front-end/basic-usage/events/intro/"), console.groupEnd();
}
var R = 0;
var V = /* @__PURE__ */ new Set();
function H(e2) {
  return R += 1, !e2 && function(e3) {
    V.forEach(function(n2) {
      return n2(e3);
    });
  }(R), R;
}
function M() {
  var e2 = new Error("");
  return (e2.stack || e2.message || "").split("\n").slice(2).join("\n");
}
function K(i2, o2) {
  var a2, s2 = this, u2 = o2.Events, l2 = o2.Enum, f2 = o2.Props, p2 = f2[0], d2 = f2[1], h2 = { objId: R };
  switch (function n2(t2, r2, i3) {
    var o3 = r2.slice(0);
    var a3 = function() {
      var r3 = o3.shift();
      !r3.alias && ~z.indexOf(r3.prop) && o3.push(e(e({}, r3), { alias: r3.prop + "Async" })), Object.defineProperty(t2, r3.alias || r3.prop, { get: function() {
        var o4 = this, a4 = 1 === r3.cache, c2 = a4 && this["__" + r3.prop + "CacheValue"];
        if (!c2) {
          var s3 = M(), u3 = H(a4), l3 = function() {
            for (var n3, o5 = [], a5 = 0; a5 < arguments.length; a5++)
              o5[a5] = arguments[a5];
            void 0 !== r3.caller ? function n4(t3, r4, i4) {
              var o6 = r4.slice(0);
              var a6 = function() {
                var r5 = o6.shift();
                !r5.alias && ~z.indexOf(r5.prop) && o6.push(e(e({}, r5), { alias: r5.prop + "Async" })), Object.defineProperty(t3, r5.alias || r5.prop, { get: function() {
                  var e2 = this, o7 = 1 === r5.cache, a7 = o7 && this["__" + r5.prop + "CacheValue"];
                  if (!a7) {
                    var c3 = M(), s4 = H(o7), u4 = function() {
                      for (var e3, o8 = [], a8 = 0; a8 < arguments.length; a8++)
                        o8[a8] = arguments[a8];
                      void 0 !== r5.caller ? n4(e3 = { objId: H() }, i4[r5.caller], i4) : e3 = {};
                      return J(u4, e3, "api.caller", { obj: u4, args: o8, parentObjId: t3.objId, objId: e3.objId, prop: r5.prop }, c3), e3;
                    };
                    return u4.objId = -1, void 0 !== r5.getter && (u4.objId = s4, n4(u4, i4[r5.getter], i4)), J(t3, u4, "api.getter", { parentObjId: t3.objId, objId: u4.objId, prop: r5.prop }, c3, function() {
                      delete e2["__" + r5.prop + "CacheValue"];
                    }), o7 && (this["__" + r5.prop + "CacheValue"] = u4), u4;
                  }
                  return a7;
                }, set: function(e2) {
                  var n5 = M();
                  return J(t3, {}, "api.setter", { value: e2, parentObjId: t3.objId, objId: -1, prop: r5.prop }, n5);
                } });
              };
              for (; o6.length; )
                a6();
            }(n3 = { objId: H() }, i3[r3.caller], i3) : n3 = {};
            return J(l3, n3, "api.caller", { obj: l3, args: o5, parentObjId: t2.objId, objId: n3.objId, prop: r3.prop }, s3), n3;
          };
          return l3.objId = -1, void 0 !== r3.getter && (l3.objId = u3, n2(l3, i3[r3.getter], i3)), J(t2, l3, "api.getter", { parentObjId: t2.objId, objId: l3.objId, prop: r3.prop }, s3, function() {
            delete o4["__" + r3.prop + "CacheValue"];
          }), a4 && (this["__" + r3.prop + "CacheValue"] = l3), l3;
        }
        return c2;
      }, set: function(e2) {
        var n3 = M();
        return J(t2, {}, "api.setter", { value: e2, parentObjId: t2.objId, objId: -1, prop: r3.prop }, n3);
      } });
    };
    for (; o3.length; )
      a3();
  }(h2, p2, d2), h2.Events = u2, h2.Enum = l2, i2.Enum = h2.Enum, i2.Events = h2.Events, i2.Props = f2, A(i2.url)) {
    case c.writer:
      i2.WordApplication = i2.WpsApplication = function() {
        return h2;
      };
      break;
    case c.spreadsheet:
      i2.ExcelApplication = i2.EtApplication = function() {
        return h2;
      };
      break;
    case c.presentation:
      i2.PPTApplication = i2.WppApplication = function() {
        return h2;
      };
      break;
    case c.pdf:
      i2.PDFApplication = function() {
        return h2;
      };
  }
  i2.Application = h2, i2.Free = function(e2) {
    return S("api.free", { objId: e2 }, "");
  }, i2.Stack = h2.Stack = (a2 = function(e2) {
    i2 && i2.Free(e2);
  }, function() {
    var e2 = [], n2 = function(n3) {
      e2.push(n3);
    };
    return V.add(n2), { End: function() {
      a2(e2), V.delete(n2);
    } };
  });
  var b2 = {};
  r.add(function(e2) {
    return n(s2, void 0, void 0, function() {
      var n2, i3, o3, a3, c2;
      return t(this, function(t2) {
        switch (t2.label) {
          case 0:
            return v(e2) ? [2] : "api.event" === (n2 = r.parse(e2.data)).eventName && n2.data ? (i3 = n2.data, o3 = i3.eventName, a3 = i3.data, (c2 = b2[o3]) ? [4, c2(a3)] : [3, 2]) : [3, 2];
          case 1:
            t2.sent(), t2.label = 2;
          case 2:
            return [2];
        }
      });
    });
  }), h2.Sub = {};
  var m2 = function(e2) {
    var n2 = u2[e2];
    Object.defineProperty(h2.Sub, n2, { set: function(e3) {
      W(), b2[n2] = e3, y({ eventName: "api.event.register", data: { eventName: n2, register: !!e3, objId: R += 1 } });
    } });
  };
  for (var g2 in u2)
    m2(g2);
}
var z = ["ExportAsFixedFormat", "GetOperatorsInfo", "ImportDataIntoFields", "ReplaceText", "ReplaceBookmark", "GetBookmarkText", "GetComments"];
function J(e2, n2, t2, r2, i2, o2) {
  var a2, c2 = (e2.done ? e2.done() : Promise.resolve()).then(function() {
    return a2 || (a2 = S(t2, r2, i2, o2)), a2;
  });
  n2.done = function() {
    return c2;
  }, n2.then = function(e3, t3) {
    return r2.objId >= 0 ? (n2.then = null, n2.catch = null, c2.then(function() {
      e3(n2);
    }).catch(function(e4) {
      return t3(e4);
    })) : c2.then(e3, t3);
  }, n2.catch = function(e3) {
    return c2.catch(e3);
  }, n2.Destroy = function() {
    return S("api.free", { objId: n2.objId }, "");
  };
}
var G = {};
var U = null;
var Z = { fileOpen: "fileOpen", tabSwitch: "tabSwitch", fileSaved: "fileSaved", fileStatus: "fileStatus", fullscreenChange: "fullscreenChange", error: "error", stage: "stage" };
var Q = { getToken: "api.getToken", onToast: "event.toast", onHyperLinkOpen: "event.hyperLinkOpen", getClipboardData: "api.getClipboardData" };
function X(i2, o2, a2, c2, s2, u2, l2) {
  var f2 = this;
  void 0 === a2 && (a2 = {});
  r.add(function(p2) {
    return n(f2, void 0, void 0, function() {
      var n2, f3, d2, h2, b2, m2, g2, w2, k2, O2, I2, j2, E2, T2, S2, _2, x2, C2, A2;
      return t(this, function(t2) {
        switch (t2.label) {
          case 0:
            return v(p2) ? [2] : (n2 = r.parse(p2.data), f3 = n2.eventName, d2 = void 0 === f3 ? "" : f3, h2 = n2.data, b2 = void 0 === h2 ? null : h2, m2 = n2.url, g2 = void 0 === m2 ? null : m2, -1 !== ["wps.jssdk.api"].indexOf(d2) ? [2] : "ready" !== d2 ? [3, 1] : (s2.apiReadySended && function(e2) {
              var n3 = [];
              Object.keys(G).forEach(function(t3) {
                G[t3].forEach(function(r2) {
                  var i3 = t3;
                  e2.off(i3, r2), n3.push({ handle: r2, eventName: i3 });
                }), delete G[t3];
              }), n3.forEach(function(e3) {
                var n4 = e3.eventName, t3 = e3.handle;
                null == U || U.ApiEvent.AddApiEventListener(n4, t3);
              });
            }(o2), y({ eventName: "setConfig", data: e(e({}, a2), { version: i2.version }) }), i2.tokenData && i2.setToken(e(e({}, i2.tokenData), { hasRefreshTokenConfig: !!a2.refreshToken })), i2.iframeReady = true, [3, 15]));
          case 1:
            return "error" !== d2 ? [3, 2] : (o2.emit(Z.error, b2), [3, 15]);
          case 2:
            return "open.result" !== d2 ? [3, 3] : (void 0 !== (null === (x2 = null == b2 ? void 0 : b2.fileInfo) || void 0 === x2 ? void 0 : x2.officeVersion) && (i2.mainVersion = b2.fileInfo.officeVersion, console.log("WebOfficeSDK Main Version: V" + i2.mainVersion)), o2.emit(Z.fileOpen, b2), [3, 15]);
          case 3:
            return "api.scroll" !== d2 ? [3, 4] : (window.scrollTo(b2.x, b2.y), [3, 15]);
          case 4:
            if (d2 !== Q.getToken)
              return [3, 9];
            w2 = { token: false }, t2.label = 5;
          case 5:
            return t2.trys.push([5, 7, , 8]), [4, s2.refreshToken()];
          case 6:
            return w2 = t2.sent(), [3, 8];
          case 7:
            return k2 = t2.sent(), console.error("refreshToken: " + (k2 || "fail to get")), [3, 8];
          case 8:
            return y({ eventName: Q.getToken + ".reply", data: w2 }), [3, 15];
          case 9:
            if (d2 !== Q.getClipboardData)
              return [3, 14];
            O2 = { text: "", html: "" }, t2.label = 10;
          case 10:
            return t2.trys.push([10, 12, , 13]), [4, s2.getClipboardData()];
          case 11:
            return O2 = t2.sent(), [3, 13];
          case 12:
            return I2 = t2.sent(), console.error("getClipboardData: " + (I2 || "fail to get")), [3, 13];
          case 13:
            return y({ eventName: Q.getClipboardData + ".reply", data: O2 }), [3, 15];
          case 14:
            d2 === Q.onToast ? s2.onToast(b2) : d2 === Q.onHyperLinkOpen ? s2.onHyperLinkOpen(b2) : "stage" === d2 ? o2.emit(Z.stage, b2) : "event.callback" === d2 ? (j2 = b2.eventName, E2 = b2.data, T2 = j2, "fullScreenChange" === j2 && (T2 = Z.fullscreenChange), "file.saved" === j2 && (T2 = Z.fileStatus), ((null === (C2 = a2.commonOptions) || void 0 === C2 ? void 0 : C2.isBrowserViewFullscreen) || (null === (A2 = a2.commonOptions) || void 0 === A2 ? void 0 : A2.isParentFullscreen)) && "fullscreenchange" === T2 && (S2 = E2.status, _2 = E2.isDispatchEvent, a2.commonOptions.isBrowserViewFullscreen ? function(e2, n3, t3, r2) {
              0 === e2 ? n3.style = "position: static; width: " + t3.width + "; height: " + t3.height : 1 === e2 && (n3.style = "position: absolute; width: 100%; height: 100%"), r2 && function(e3) {
                ["fullscreen", "fullscreenElement"].forEach(function(n5) {
                  Object.defineProperty(document, n5, { get: function() {
                    return !!e3.status;
                  }, configurable: true });
                });
                var n4 = new CustomEvent("fullscreenchange");
                document.dispatchEvent(n4);
              }({ status: e2 });
            }(S2, u2, l2, _2) : a2.commonOptions.isParentFullscreen && function(e2, n3, t3) {
              var r2 = document.querySelector(t3), i3 = r2 && 1 === r2.nodeType ? r2 : n3;
              if (0 === e2) {
                var o3 = document, a3 = o3.exitFullscreen || o3.mozCancelFullScreen || o3.msExitFullscreen || o3.webkitCancelFullScreen || o3.webkitExitFullscreen;
                a3.call(document);
              } else if (1 === e2) {
                var c3 = i3.requestFullscreen || i3.mozRequestFullScreen || i3.msRequestFullscreen || i3.webkitRequestFullscreen;
                c3.call(i3);
              }
            }(S2, u2, a2.commonOptions.isParentFullscreen)), o2.emit(T2, E2)) : "api.ready" === d2 && K(i2, b2), t2.label = 15;
          case 15:
            return "function" == typeof c2[d2] && c2[d2](i2, g2 || b2), [2];
        }
      });
    });
  });
}
function Y(e2) {
  return new Promise(function(n2) {
    var t2 = function(i2) {
      v(i2) || r.parse(i2.data).eventName === e2 && (n2(), r.remove(t2));
    };
    r.add(t2);
  });
}
function $(a2) {
  var c2, s2 = this;
  void 0 === a2 && (a2 = {}), U && U.destroy();
  try {
    var u2 = x(a2), l2 = u2.subscriptions, f2 = void 0 === l2 ? {} : l2, d2 = u2.mount, v2 = void 0 === d2 ? null : d2, h2 = u2.url, b2 = u2.refreshToken, m2 = u2.onToast, g2 = u2.onHyperLinkOpen, k2 = u2.getClipboardData;
    p("origin", (h2.match(/https*:\/\/[^\/]+/g) || [])[0]);
    var j2 = w(h2, v2), E2 = Y("ready"), T2 = Y("open.result"), S2 = Y("api.ready"), _2 = v2 ? { width: v2.clientWidth + "px", height: v2.clientHeight + "px" } : { width: "100vw", height: "100vh" };
    delete u2.mount, h2 && delete u2.url, delete u2.subscriptions;
    var C2 = (c2 = c2 || /* @__PURE__ */ Object.create(null), { on: function(e2, n2) {
      (c2[e2] || (c2[e2] = [])).push(n2);
    }, off: function(e2, n2) {
      c2[e2] && c2[e2].splice(c2[e2].indexOf(n2) >>> 0, 1);
    }, emit: function(e2, n2) {
      (c2[e2] || []).slice().map(function(e3) {
        e3(n2);
      }), (c2["*"] || []).slice().map(function(t2) {
        t2(e2, n2);
      });
    } }), A2 = { apiReadySended: false }, L2 = function(e2, r2, i2) {
      return n(s2, void 0, void 0, function() {
        return t(this, function(n2) {
          switch (n2.label) {
            case 0:
              return function(e3, n3, t2) {
                if (G[e3]) {
                  var r3 = !!G[e3].find(function(e4) {
                    return e4 === n3;
                  });
                  return r3 && "off" === t2 ? (C2.off(e3, n3), G[e3] = G[e3].filter(function(e4) {
                    return e4 !== n3;
                  }), !!G[e3].length || (G[e3] = void 0, false)) : (r3 || "on" !== t2 || (G[e3].push(n3), C2.on(e3, n3)), true);
                }
                return "on" === t2 ? (G[e3] = [], G[e3].push(n3), false) : "off" === t2 || void 0;
              }(e2, r2, i2) ? [3, 2] : [4, E2];
            case 1:
              n2.sent(), function(e3, n3) {
                var t2 = e3.eventName, r3 = e3.type, i3 = e3.handle;
                "on" === n3 ? C2.on(t2, i3) : C2.off(t2, i3), "base.event" === r3 && y({ eventName: "basic.event", data: { eventName: t2, action: n3 } }), W();
              }(function(e3, n3) {
                var t2 = e3, r3 = "base.event";
                switch (t2) {
                  case Z.fileSaved:
                    console.warn("fileSaved事件监听即将弃用， 推荐使用fileStatus进行文件状态的监听"), t2 = "fileStatus";
                    break;
                  case Z.fullscreenChange:
                    t2 = "fullscreenchange";
                    break;
                  case "error":
                  case "fileOpen":
                    r3 = "callback.event";
                }
                return { eventName: t2, type: r3, handle: n3 };
              }(e2, r2), i2), n2.label = 2;
            case 2:
              return [2];
          }
        });
      });
    };
    return U = { url: h2, iframe: j2, version: "1.1.20", iframeReady: false, tokenData: null, commandBars: null, tabs: { getTabs: function() {
      return n(this, void 0, void 0, function() {
        return t(this, function(e2) {
          switch (e2.label) {
            case 0:
              return [4, E2];
            case 1:
              return e2.sent(), [2, I({ api: "tab.getTabs" })];
          }
        });
      });
    }, switchTab: function(e2) {
      return n(this, void 0, void 0, function() {
        return t(this, function(n2) {
          switch (n2.label) {
            case 0:
              return [4, E2];
            case 1:
              return n2.sent(), [2, I({ api: "tab.switchTab", args: { tabKey: e2 } })];
          }
        });
      });
    } }, setCooperUserColor: function(e2) {
      return n(this, void 0, void 0, function() {
        return t(this, function(n2) {
          switch (n2.label) {
            case 0:
              return [4, E2];
            case 1:
              return n2.sent(), [2, I({ api: "setCooperUserColor", args: e2 })];
          }
        });
      });
    }, setToken: function(e2) {
      return n(this, void 0, void 0, function() {
        return t(this, function(n2) {
          switch (n2.label) {
            case 0:
              return [4, E2];
            case 1:
              return n2.sent(), U.tokenData = e2, y({ eventName: "setToken", data: e2 }), [2];
          }
        });
      });
    }, ready: function() {
      return n(this, void 0, void 0, function() {
        return t(this, function(e2) {
          switch (e2.label) {
            case 0:
              return A2.apiReadySended ? [3, 2] : [4, T2];
            case 1:
              e2.sent(), A2.apiReadySended = true, y({ eventName: "api.ready" }), e2.label = 2;
            case 2:
              return [4, S2];
            case 3:
              return e2.sent(), [2, new Promise(function(e3) {
                return setTimeout(function() {
                  return e3(null == U ? void 0 : U.Application);
                }, 0);
              })];
          }
        });
      });
    }, destroy: function() {
      G = {}, j2.destroy(), r.empty(), U = null, V = /* @__PURE__ */ new Set(), R = 0, document.removeEventListener("fullscreenchange", F), B();
    }, save: function() {
      return n(this, void 0, void 0, function() {
        return t(this, function(e2) {
          switch (e2.label) {
            case 0:
              return [4, E2];
            case 1:
              return e2.sent(), [2, O({ api: "save" })];
          }
        });
      });
    }, setCommandBars: function(e2) {
      return n(this, void 0, void 0, function() {
        return t(this, function(n2) {
          switch (n2.label) {
            case 0:
              return [4, E2];
            case 1:
              return n2.sent(), N(e2), [2];
          }
        });
      });
    }, updateConfig: function(e2) {
      return void 0 === e2 && (e2 = {}), n(this, void 0, void 0, function() {
        return t(this, function(n2) {
          switch (n2.label) {
            case 0:
              return [4, E2];
            case 1:
              return n2.sent(), e2.commandBars ? (console.warn("Deprecated: `updateConfig()` 方法即将废弃，请使用`setCommandBars()`代替`updateConfig()`更新`commandBars`配置。"), [4, N(e2.commandBars)]) : [3, 3];
            case 2:
              n2.sent(), n2.label = 3;
            case 3:
              return [2];
          }
        });
      });
    }, executeCommandBar: function(e2) {
      return n(this, void 0, void 0, function() {
        return t(this, function(n2) {
          switch (n2.label) {
            case 0:
              return [4, E2];
            case 1:
              return n2.sent(), N([{ cmbId: e2, attributes: [{ name: "click", value: true }] }]), [2];
          }
        });
      });
    }, on: function(e2, r2) {
      return n(this, void 0, void 0, function() {
        return t(this, function(n2) {
          return [2, this.ApiEvent.AddApiEventListener(e2, r2)];
        });
      });
    }, off: function(e2, r2) {
      return n(this, void 0, void 0, function() {
        return t(this, function(n2) {
          return [2, this.ApiEvent.RemoveApiEventListener(e2, r2)];
        });
      });
    }, ApiEvent: { AddApiEventListener: function(e2, r2) {
      return n(this, void 0, void 0, function() {
        return t(this, function(n2) {
          switch (n2.label) {
            case 0:
              return [4, L2(e2, r2, "on")];
            case 1:
              return [2, n2.sent()];
          }
        });
      });
    }, RemoveApiEventListener: function(e2, r2) {
      return n(this, void 0, void 0, function() {
        return t(this, function(n2) {
          switch (n2.label) {
            case 0:
              return [4, L2(e2, r2, "off")];
            case 1:
              return [2, n2.sent()];
          }
        });
      });
    } } }, function(e2, n2, t2, r2, i2, a3) {
      n2 && o(n2) && (i2.refreshToken = n2, e2.refreshToken = { eventName: Q.getToken });
      a3 && o(a3) && (i2.getClipboardData = a3, e2.getClipboardData = { eventName: Q.getClipboardData });
      t2 && o(t2) && (i2.onToast = t2, e2.onToast = { eventName: Q.onToast });
      r2 && o(r2) && (i2.onHyperLinkOpen = r2, e2.onHyperLinkOpen = { eventName: Q.onHyperLinkOpen });
    }(u2, b2, m2, g2, A2, k2), X(U, C2, u2, f2, A2, j2, _2), u2.fileToken && (i(u2.fileToken) ? U.setToken(e({}, u2.fileToken)) : U.setToken({ token: u2.fileToken })), U;
  } catch (e2) {
    console.error(e2);
  }
}
function ee(n2) {
  var t2 = e({}, n2);
  if (t2.url)
    throw Error("[WebOfficeSDK.init] 不支持传递url，请使用appId、fileId、officeType、fileToken等参数初始化！");
  if (!t2.appId || !t2.fileId || !t2.officeType)
    throw Error("[WebOfficeSDK.init] appId、fileId、officeType为必选项！");
  return t2.endpoint = t2.endpoint || "https://o.wpsgo.com", $(C(t2));
}
console.log("WebOfficeSDK JS-SDK V1.1.20");
var ne = Object.freeze({ __proto__: null, listener: X, config: $, createApp: ee, get OfficeType() {
  return a;
} });
window.WPS = ne;
var te = $;
var re = ee;
var ie = a;
var index_esm_default = { config: $, init: ee, OfficeType: a };
export {
  ie as OfficeType,
  te as config,
  index_esm_default as default,
  re as init
};
//# sourceMappingURL=ts-wps.js.map
