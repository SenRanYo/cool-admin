import{watch as n,unref as e,inject as t,computed as o,watchEffect as r,Vue2 as i,defineComponent as a,shallowRef as u,toRefs as s,getCurrentInstance as c,onMounted as l,onBeforeUnmount as f,h as v,nextTick as p}from"vue-demi";import{throttle as d,init as g}from"echarts/core";import{addListener as h,removeListener as m}from"resize-detector";var O=function(){return O=Object.assign||function(n){for(var e,t=1,o=arguments.length;t<o;t++)for(var r in e=arguments[t])Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n},O.apply(this,arguments)},_=["getWidth","getHeight","getDom","getOption","resize","dispatchAction","convertToPixel","convertFromPixel","containPixel","getDataURL","getConnectedDataURL","appendData","clear","isDisposed","dispose"];function E(n){return e=Object.create(null),_.forEach((function(t){e[t]=function(e){return function(){for(var t=[],o=0;o<arguments.length;o++)t[o]=arguments[o];if(!n.value)throw new Error("ECharts is not initialized yet.");return n.value[e].apply(n.value,t)}}(t)})),e;var e}var b={autoresize:Boolean},y=/^on[^a-z]/,j=function(n){return y.test(n)};function x(n,t){var o=e(n);return o&&"object"==typeof o&&"value"in o?o.value||t:o||t}var L="ecLoadingOptions";var z={loading:Boolean,loadingOptions:Object},w=null;var A=function(){if(null!=w)return w;if("undefined"==typeof HTMLElement||"undefined"==typeof customElements)return w=!1;try{new Function("tag","class EChartsElement extends HTMLElement {\n  __dispose = null;\n\n  disconnectedCallback() {\n    if (this.__dispose) {\n      this.__dispose();\n      this.__dispose = null;\n    }\n  }\n}\n\nif (customElements.get(tag) == null) {\n  customElements.define(tag, EChartsElement);\n}\n")("x-vue-echarts")}catch(n){return w=!1}return w=!0}();i&&i.config.ignoredElements.push("x-vue-echarts");var C="ecTheme",U="ecInitOptions",D="ecUpdateOptions",T=a({name:"echarts",props:O(O({option:Object,theme:{type:[Object,String]},initOptions:Object,updateOptions:Object,group:String,manualUpdate:Boolean},b),z),emits:{},inheritAttrs:!1,setup:function(e,i){var a=i.attrs,v=u(),_=u(),b=u(),y=t("ecTheme",null),L=t("ecInitOptions",null),z=t("ecUpdateOptions",null),w=s(e),C=w.autoresize,U=w.manualUpdate,D=w.loading,T=w.loadingOptions,P=o((function(){return b.value||e.option||null})),k=o((function(){return e.theme||x(y,{})})),B=o((function(){return e.initOptions||x(L,{})})),H=o((function(){return e.updateOptions||x(z,{})})),M=o((function(){return function(n){var e={};for(var t in n)j(t)||(e[t]=n[t]);return e}(a)})),F=c().proxy.$listeners;function I(n){if(v.value){var t=_.value=g(v.value,k.value,B.value);e.group&&(t.group=e.group);var o=F;o||(o={},Object.keys(a).filter((function(n){return 0===n.indexOf("on")&&n.length>2})).forEach((function(n){var e=n.charAt(2).toLowerCase()+n.slice(3);"Once"===e.substring(e.length-4)&&(e="~".concat(e.substring(0,e.length-4))),o[e]=a[n]}))),Object.keys(o).forEach((function(n){var e=o[n];if(e){var r=n.toLowerCase();"~"===r.charAt(0)&&(r=r.substring(1),e.__once__=!0);var i=t;if(0===r.indexOf("zr:")&&(i=t.getZr(),r=r.substring(3)),e.__once__){delete e.__once__;var a=e;e=function(){for(var n=[],t=0;t<arguments.length;t++)n[t]=arguments[t];a.apply(void 0,n),i.off(r,e)}}i.on(r,e)}})),C.value?p((function(){t&&!t.isDisposed()&&t.resize(),r()})):r()}function r(){var e=n||P.value;e&&t.setOption(e,H.value)}}function R(){_.value&&(_.value.dispose(),_.value=void 0)}var S=null;n(U,(function(t){"function"==typeof S&&(S(),S=null),t||(S=n((function(){return e.option}),(function(n,e){n&&(_.value?_.value.setOption(n,O({notMerge:n!==e},H.value)):I())}),{deep:!0}))}),{immediate:!0}),n([k,B],(function(){R(),I()}),{deep:!0}),r((function(){e.group&&_.value&&(_.value.group=e.group)}));var W=E(_);return function(n,e,i){var a=t("ecLoadingOptions",{}),u=o((function(){return O(O({},x(a,{})),null==i?void 0:i.value)}));r((function(){var t=n.value;t&&(e.value?t.showLoading(u.value):t.hideLoading())}))}(_,D,T),function(e,t,o){var r=null;n([o,e,t],(function(n,e,t){var o=n[0],i=n[1],a=n[2];o&&i&&a&&(r=d((function(){i.resize()}),100),h(o,r)),t((function(){r&&o&&m(o,r)}))}))}(_,C,v),l((function(){I()})),f((function(){A&&v.value?v.value.__dispose=R:R()})),O({chart:_,root:v,setOption:function(n,t){e.manualUpdate&&(b.value=n),_.value?_.value.setOption(n,t||{}):I(n)},nonEventAttrs:M},W)},render:function(){var n=i?{attrs:this.nonEventAttrs}:O({},this.nonEventAttrs);return n.ref="root",n.class=n.class?["echarts"].concat(n.class):"echarts",v("x-vue-echarts",n)}});export{U as INIT_OPTIONS_KEY,L as LOADING_OPTIONS_KEY,C as THEME_KEY,D as UPDATE_OPTIONS_KEY,T as default};
//# sourceMappingURL=index.esm.min.js.map
